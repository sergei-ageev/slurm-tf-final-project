# Инструкция

1. Доступ по SSH к ВМ осуществляется через веб-интерфейс Yandex Cloud с указанием логина и пароля из роли ansible: packer/ansible/create_user/defaults/main.yaml - переменные USER и PASSWORD. Данные переменные необходимо задать заранее. Также, как и публичный ключ в переменной SSH_PUBLIC_KEY.

2. Для создания образа через Packer в директории с файлом nginx.pkr.hcl выполните команду:

    yc vpc subnet list

3. Запишите идентификатор подсети (столбец ID), в которой будет размещаться вспомогательная ВМ, на основе которой создается образ, а также соответствующую зону доступности (столбец ZONE). Эти параметры потребуются в дальнейшем.

4. Задайте в командной строке значения переменных, используемых в процессе сборки образа.

    export YC_FOLDER_ID=$(yc config get folder-id)
    export YC_ZONE="<зона_доступности>"
    export YC_SUBNET_ID="<идентификатор_подсети>"
    export YC_TOKEN=$(yc iam create-token)

Где:

    YC_FOLDER_ID — идентификатор каталога, в котором будет размещена вспомогательная ВМ, на основе которой создается образ. Заполняется автоматически.
    YC_ZONE — зона доступности, в которой будет размещена вспомогательная ВМ, на основе которой создается образ. Получена ранее.
    YC_SUBNET_ID — идентификатор подсети, в которой будет размещена вспомогательная ВМ, на основе которой создается образ. Получен ранее.
    YC_TOKEN — IAM-токен. Нужен для создания образа ВМ, заполняется автоматически.
